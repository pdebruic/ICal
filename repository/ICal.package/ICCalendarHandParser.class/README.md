This is a recursively descending parser written by hand because I couldn't get the smacc one working.